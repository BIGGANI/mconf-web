#!/usr/bin/env ruby

COMMON_PACKAGES = %w( libopenssl-ruby wget make curl aspell-es aspell-en libxml2-dev libxslt-dev libmagickcore-dev libmagickwand-dev imagemagick )
LINUX_PACKAGES = {
  :production => COMMON_PACKAGES + %w( awstats logrotate nfs-common libmysqlclient15-dev mysql-server ),
  :development => COMMON_PACKAGES + %w( libsqlite3-dev )
}

def install_linux_packages(set)
  unless `uname`.chomp == "Linux" && `which apt-get` != ""
    puts "Cannot proceed: are you on linux? do you have apt-get?"
    return
  end

  puts "* Installing Linux packages for \"#{set}\" environment"
  if LINUX_PACKAGES[set].nil?
    puts "Can't proceed: wrong enviroment \"#{set}\""
  else
    system "sudo apt-get install #{LINUX_PACKAGES[set].join(" ")}"
  end
end

def print_usage
  puts "Usage: setup ENV"
  puts
  puts "ENVIRONMENTS:"
  puts "  production   - Setup production environment"
  puts "  development  - Setup development environment"
  puts
end

unless ARGV[0].nil?
  install_linux_packages(ARGV[0].to_sym)
else
  puts "Missing arguments."
  print_usage()
end


