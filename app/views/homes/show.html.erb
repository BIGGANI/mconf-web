
<% content_for :headers do  -%>
  <%= javascript_include_tag 'jquery.filestyle', 'fckeditor/fckeditor' %>
<% end -%>

<% content_for :javascript do %>
	
	$(function() {
		var altura;
		$("#button").toggle(
			function() {
				altura = $("#effect").height();
				$("#effect").animate({backgroundColor: '#aa0000', color: '#fff', width: 500, height: 250}, 1000);
			},
			function() {
				$("#effect").animate({backgroundColor: '#fff', color: '#000', width: 240, height: altura}, 1000);
			}
		);
	});
	
	
	$(function() {
		$(".column").sortable({
			connectWith: '.column',
			opacity: 0.7
		});

		$(".portlet").addClass("ui-widget ui-widget-content ui-helper-clearfix ui-corner-all")
			.find(".portlet-header")
				.addClass("ui-widget-header ui-corner-all")
				.prepend('<span class="ui-icon ui-icon-plusthick"></span>')
				.prepend('<span class="ui-icon ui-icon-closethick"></span>')
				.end()
			.find(".portlet-content");

		$(".portlet-header .ui-icon").click(function() {
			$(this).toggleClass("ui-icon-minusthick");
			$(this).parents(".portlet:first").find(".portlet-content").toggle();
		});

		$(".portlet-header .ui-icon-closethick").click(function() {
			$(this).parents(".portlet:first").hide();
		});
		
		$(".column").disableSelection();
	});


/*
 *  Expand and collapse thread
 */
  extend_thread = function(id){
    $("#parent_" + id + " .extended_thread").show();
    $("#parent_" + id + " .extend_thread").hide();
    $("#parent_" + id + " .collapse_thread").show();
    $("#message-body-" + id).hide();
  }
	
  collapse_thread = function(id){
    $("#parent_" + id + " .extended_thread").hide();
    $("#parent_" + id + " .extend_thread").show();
    $("#parent_" + id + " .collapse_thread").hide();
    $("#message-body-" + id).show();
  }  
  
  
  $("input#checkposts").click(function(){
    $(".post_cloud").slideToggle("slow");
  });
  
  $("input#events").click(function(){
    $(".event_cloud").slideToggle("slow");
  });
  
  $("input#news").click(function(){
    $(".news_cloud").slideToggle("slow");
  });
  
  
<% end %>


	<style type="text/css">
	.column { width: 250px; float: left; padding-bottom: 100px;}
	.portlet { margin: 0 1em 1em 0;background:#fff;}
	.portlet-header { margin: 0.3em; padding-bottom: 4px; padding-left: 0.2em;cursor:pointer; }
	.portlet-header .ui-icon { float: right; }
	.portlet-content { padding: 0.4em; }
	.ui-sortable-placeholder { border: 1px dotted black; visibility: visible !important; height: 50px !important; }
	.ui-sortable-placeholder * { visibility: hidden; }
	</style>

<style type="text/css">
		.toggler { width: 500px; height: 200px; position: relative;}
		#button { padding: .5em 1em; text-decoration: none; }
		#effect { width: 240px;padding: 0.4em; position: relative; background: #fff; }
		#effect h3 { margin: 0; padding: 0.4em; text-align: center; }
	</style>
	
<div class="demo">

<div id="wrap" class="toggler">
	<div id="effect" class="ui-widget-content ui-corner-all">
		<h3 class="ui-widget-header ui-corner-all">Animate <a href="#" id="button" class="ui-state-default ui-corner-all">Toggle Effect</a></h3>
		<p>
			Etiam libero neque, luctus a, eleifend nec, semper at, lorem. Sed pede. Nulla lorem metus, adipiscing ut, luctus sed, hendrerit vitae, mi.
		</p>
	</div>
</div>



</div><!-- End demo -->

<div style="display: none;" class="demo-description">

<p>Click the button above to preview the effect.</p>

</div>

	
<div class="column">

  <div class="portlet">
  <div class="next-events">
<<<<<<< Updated upstream:app/views/homes/show.html.erb
     <div class="next-events-title">
       <h3><%=image_tag("icons/date.png",:class=>"icon") + " " + t('calendar.my')%> <span class="small-font">(GMT <%= Time.zone.formatted_offset %> )</span></h3>
=======
     <div class="portlet-header">
	 <div class="next-events-title">
       <p><strong><%=image_tag("icons/date.png",:class=>"icon") + t('calendar.my')%></strong> <span class="small-font">(GMT <%= Time.zone.formatted_offset %> )</span></p>
>>>>>>> Stashed changes:app/views/homes/show.html.erb
     </div>
	</div>
	
	<div class="portlet-content">
	  <div class="next-events-section">
	    <%if @today_events.empty?%>
	      <span class="bold"><%=t('today')%></span> <%=t('event.no_events')%> <br/>
	    <%else%>
	      <span class="bold"><%=t('today')%></span>
	      <ul>
		  <% for event in @today_events -%>
                <li class="event">
                  <%event_link="<span class='red'>" + sanitize(event.title) + "</span> <br/> <span class='small-font unified_date'>" + event.start_date.to_formatted_s(:short) + " - " + event.end_date.to_formatted_s(:short) + "</span>"%>
                  <%=link_to event_link, space_event_path(event.space,event)%>
                  <%=link_to "", space_event_path(event.space,event),:class=>"box-link"%>
                </li>
          <%end%>
		  </ul>
	    <%end%>
	  </div>
	  <div class="next-events-section">
	    <%if @tomorrow_events.empty?%>
	      <span class="bold"><%=t('tomorrow')%></span> <%=t('event.no_events')%> <br/>
	    <%else%>
	      <span class="bold"><%=t('tomorrow')%></span>
	      <ul>
		    <% for event in @tomorrow_events -%>
              <li class="event">
                <%event_link="<span class='red'>" + sanitize(event.title) + "</span> <br/><span class='small-font unified_date'>" + event.start_date.to_formatted_s(:short) + " - " + event.end_date.to_formatted_s(:short) + "</span>"%>
                <%=link_to event_link, space_event_path(event.space,event)%>
                <%=link_to "", space_event_path(event.space,event),:class=>"box-link"%>
              </li>
            <% end -%>
	      </ul>
		<%end%>
	  </div>
	  <div class="next-events-section">
	    <%if @week_events.empty?%>
	      <span class="bold blue"><%=t('week.next')%></span> <%=t('event.no_events')%> <br/>
	    <%else%>
	      <span class="bold blue"><%=t('week.next')%></span>
	      <ul>
		    <% for event in @week_events -%>
              <li class="event">
                <%event_link="<span class='red'>" + sanitize(event.title) + "</span> <br/> <span class='small-font unified_date'>" + event.start_date.to_formatted_s(:short) + " - " + event.end_date.to_formatted_s(:short) + "</span>"%>
                <%=link_to event_link, space_event_path(event.space,event)%>
                <%=link_to "", space_event_path(event.space,event),:class=>"box-link"%>
              </li>
            <% end -%>
	      </ul>
		<%end%>
	  </div>
	  <div class="next-events-section">
	    <%if @upcoming_events.empty?%>
	      <span class="bold blue"><%=t('event.upcoming.other')%></span> <%=t('event.no_events') %><br/>
	    <%else%>
	      <span class="bold blue"><%=t('event.upcoming.other')%></span>
	      <ul>
		    <% for event in @upcoming_events -%>
              <li class="event">
                <%event_link="<span class='red'>" + sanitize(event.title) + "</span><br/> <span class='small-font unified_date'>" + event.start_date.to_formatted_s(:short) + " - " + event.end_date.to_formatted_s(:short) + "</span>"%>
                <%=link_to event_link, space_event_path(event.space,event)%>
                <%=link_to "", space_event_path(event.space,event),:class=>"box-link"%>
              </li>
            <% end -%>
	      </ul>
		<%end%>
	  </div> 
<<<<<<< Updated upstream:app/views/homes/show.html.erb
	
  </div>
  
  <div id="home-inbox-full" class="margin-up">
    
	<div id="home-inbox-title">
    	<h3><%=image_tag("icons/email.png",:class=>"icon")%> <%= link_to t('inbox.my', :checked => PrivateMessage.inbox(current_user).select{|msg| !msg.checked}.size), user_messages_path(current_user), menu_options(:inbox, :id => "user_inbox_link")%></h3>
	</div>
	<%if @private_messages.empty?%>
	  <div class="next-events-section">
	    <span> <%=t("message.private.none")%></span>
	  </div> 	
	<%else%>
	    <% for private_message in @private_messages %>
	      <%@sender=User.find_with_disabled(private_message.sender_id)%>
		  <div class="next-events-section">
		      <div class="user-logo"><%=link_logo(@sender,:size=>32, :url => user_profile_path(@sender), :title=>@sender.login)%></div>  
		      <div class="home-inbox-message">
		        <span class="home-inbox-topic"> <%= link_to first_words(sanitize(private_message.title),25), user_messages_path(current_user, :message=>private_message.id)%></span><br/>
		        <%= sanitize(first_words(private_message.body,35))%>
		      </div>
		  </div>  
	    <% end %>
	<% end %>
  </div>
<% end %>  


<div id="recent-activity">

  <%unless @today.empty?%>
    <div id="line">
		<span class="bold">Today</span>
    </div>
  <%end%>
  <%today_last_item = @today.last%>
  <% for item in @today do %>

	<%if item.class == Post %>
	  <%@space=item.space%>
	  
	  <%= render :partial => "posts/post_in_home" , :locals => {:thread => item, :extended => false, :last => item==today_last_item } %>
	<%elsif item.class == Event %>
	  <%@space=item.space%>
	  <%= render :partial => 'events/event_in_home', :locals => {:event=>item, :last => item==today_last_item} %>
	<%elsif item.class == News %>
	  <%@space=item.space%>
	  <%@news_to_show = item%>
	  <%@news_position = 1 %>
	  <%@news=[]%>
	  <%= render :partial => 'spaces/news_in_home', :locals =>{:last => item==today_last_item}%>
	<%else%>
	  I don't know what is a "<%item.class%>"
	<%end%>
  <% end %>
  <%unless @yesterday.empty?%>
    <div id="line">
		<span class="bold">Yesterday</span>
    </div>
  <%end%>
  <%yesterday_last_item = @yesterday.last%>
  
  <% for item in @yesterday do %>	
	<%if item.class == Post %>
	  <%@space=item.space%>
	  <%= render :partial => "posts/post_in_home" , :locals => {:thread => item, :extended => false, :last => item==yesterday_last_item} %>
	<%elsif item.class == Event %>
	  <%@space=item.space%>
	  <%= render :partial => 'events/event_in_home', :locals => {:event=>item, :last => item==yesterday_last_item} %>
	<%elsif item.class == News %>
	  <%@space=item.space%>
	  <%@news_to_show = item%>
	  <%@news_position = 1 %>
	  <%@news=[]%>
	  <%= render :partial => 'spaces/news_in_home', :locals =>{:last => item==yesterday_last_item}%>
	<%else%>
	  I don't know what is a "<%item.class%>"
	<%end%>
  <% end %>
  <%unless @last_week.empty?%>
    <div id="line">
		<span class="bold">Last Week</span>
    </div>
  <%end%>
  <%week_last_item = @last_week.last%>
  <% for item in @last_week do %>	
	<%if item.class == Post %>
	  <%@space=item.space%>
	  <%= render :partial => "posts/post_in_home" , :locals => {:thread => item, :extended => false, :last => item==week_last_item} %>
	<%elsif item.class == Event %>
	  <%@space=item.space%>
	  <%= render :partial => 'events/event_in_home', :locals => {:event=>item, :last => item==week_last_item} %>
	<%elsif item.class == News %>
	  <%@space=item.space%>
	  <%@news_to_show = item%>
	  <%@news_position = 1 %>
	  <%@news=[]%>
	  <%= render :partial => 'spaces/news_in_home', :locals =>{:last => item==week_last_item}%>
	<%else%>
	  I don't know what is a "<%item.class%>"
	<%end%>
  <% end %>
  <%unless @older.empty?%>
    <div id="line">
		<span class="bold">Older items</span>
    </div>
  <%end%>
  <%older_last_item = @older.last%>
  <% for item in @older do %>	
	<%if item.class == Post %>
	  <%@space=item.space%>
	  <%= render :partial => "posts/post_in_home" , :locals => {:thread => item, :extended => false, :last => item==older_last_item} %>
	<%elsif item.class == Event %>
	  <%@space=item.space%>
	  <%= render :partial => 'events/event_in_home', :locals => {:event=>item, :last => item==older_last_item} %>
	<%elsif item.class == News %>
	  <%@space=item.space%>
	  <%@news_to_show = item%>
	  <%@news_position = 1 %>
	  <%@news=[]%>
	  <%= render :partial => 'spaces/news_in_home', :locals =>{:last => item==older_last_item}%>
	<%else%>
	  I don't know what is a "<%item.class%>"
	<%end%>
  <% end %>
  
  <%@space=nil #to avoid the selector highlight any space%>
  <%= will_paginate @all_in_all %><br/>
</div>
=======
	<br/>
	</div>
  </div>
  </div>
</div>
 
  <div class="column">
  <div class="portlet">
  <div id="home-inbox-full">
    <div id="home-inbox-title" class="portlet-header"><%=image_tag("icons/email.png",:class=>"icon")%><%= link_to t('inbox.my', :checked => PrivateMessage.inbox(current_user).select{|msg| !msg.checked}.size), user_messages_path(current_user), menu_options(:inbox, :id => "user_inbox_link")%></div>
    <div class="portlet-content">
	<% for private_message in @private_messages %>
      <%@sender=User.find_with_disabled(private_message.sender_id)%> 
      <div class="user-logo"><%=link_logo(@sender,:size=>32, :url => user_profile_path(@sender), :title=>@sender.login)%></div>  
      <div class="home-inbox-message">
        <span class="home-inbox-topic"> <%= link_to sanitize(private_message.title), user_messages_path(current_user, :message=>private_message.id)%></span><br/>
        <%= sanitize(first_words(private_message.body,35))%>
      </div>  
    <% end %>
	</div>
  </div>
  </div>
  </div>
  
  
  <div class="column">
  <div class="portlet">
  <div id="home-inbox-full">
    <div id="home-inbox-title" class="portlet-header"><%=image_tag("icons/email.png",:class=>"icon")%><%= link_to t('inbox.my', :checked => PrivateMessage.inbox(current_user).select{|msg| !msg.checked}.size), user_messages_path(current_user), menu_options(:inbox, :id => "user_inbox_link")%></div>
    <div class="portlet-content">
      <div class="home-inbox-message">
        <span class="home-inbox-topic"> Lorem ipsum etcacwuis  kldfhsklf sfhkj sflsfhsl shfklshf shlkhfklsdfs</span>
      </div>  
	</div>
  </div>
  </div>
  </div>
  
>>>>>>> Stashed changes:app/views/homes/show.html.erb
