<div id="doc_table" class="main_text">

  <%=collection_table(version_attachment(@attachments)) do |t|

      t.header :name, sortable_header(t('title'),'filename')
      t.header :author, sortable_header(t('author'),'author')
      t.header :updated, sortable_header(t('updated'),'updated_at')
      t.header :tags, t('tags')
#      t.header :type, sortable_header(t('type'),'type')
#      t.header :actions, t('actions')

      t.rows.each do |row, attachment, index|

        #expanded
        if expand_versions_to_array.include?(attachment.version_family_id)

          row[:class] += " version_expanded"

          row.name           "#{link_to image_tag("down.png"),path_for_attachments({:not_expanded => version_family_id}), :class => "table_params" if attachment.version_child_id.nil?} <span class=\"version_number\" title=\"#{t('version.one')} #{attachment.id}\">V#{attachment.id}</span> #{attachment_link(attachment)}"
          row.author         link_to attachment.author.name, user_profile_path(attachment.author)
          row.updated        "<span title=\"#{l(attachment.updated_at, :format => :long)}\">#{l(attachment.updated_at.to_date)}</span>"
          row.tags           attachment.tags.map{|t| link_to(t.name,path_for_attachments({:add_tag=>t.id}), :class=> "add_tag_filter")}.join(",")
#          row.type           "#{image_tag(attachment.logo_image_path_without_thumbnails, :alt => "")} #{attachment.mime_type.to_sym}"
#          row.actions        table_actions(attachment)

        #collapsed
        else
          row.name           "#{link_to image_tag("right.png"),path_for_attachments({:expanded => attachment.version_family_id}), :class => "table_params" if attachment.version_family.size>1} #{attachment_link(attachment)}", :rel => (attachment.mime_type.present? ? attachment.mime_type.to_sym.to_s : "")
          row.author         link_to attachment.author.name, user_profile_path(attachment.author)
          row.updated        "<span title=\"#{l(attachment.updated_at, :format => :long)}\">#{l(attachment.updated_at.to_date)}</span>"
          row.tags           attachment.tags.map{|t| link_to(t.name,path_for_attachments({:add_tag=>t.id}), :class=> "add_tag_filter")}.join(",")
#          row.type           "#{image_tag(attachment.logo_image_path_without_thumbnails, :alt => "")} #{attachment.content_type.split("/").last.upcase}"
#          row.actions        table_actions(attachment)
        end
      end
    end
  %>
</div>