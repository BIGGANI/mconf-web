/*
 * Create new space
 */

$("a.new_space_link").fancybox({
  'hideOnContentClick' : false,
	'frameHeight' : 390,
	'frameWidth' : <%=logged_in? ? '300' : '560'%>,
	'callbackOnShow' : function(){
	  $("#mail_group").hide(); 
	} 		
});

$("#create_and_login_link").livequery("click", function(){
  $(this).attr("href","javascript:void(0)").addClass("selected");
  $("#create_and_register_link").removeClass("selected")
  $.get("<%= new_space_path(:register=>false)%>",
        {authenticity_token: "<%=form_authenticity_token()%>"},
        function(data){
          $("#create_space").replaceWith(data);
					$("#fancy_outer").height($("#create_space").height() + 50);
        }
      );
});

$("#create_and_register_link").livequery("click", function(){
  $(this).attr("href","javascript:void(0)").addClass("selected");
  $("#create_and_loggin_link").removeClass("selected")
  $.get("<%= new_space_path(:register=>true)%>",
        {authenticity_token: "<%=form_authenticity_token()%>"},
        function(data){
          $("#create_space").replaceWith(data);
					$("#fancy_outer").height($("#create_space").height() + 50);
        }
      );
});


$("#check_mail input:mail").livequery("click", function(){
  if($(this).attr("checked")){
		$("#mail_group").show();
	}
	else{
	 $("#mail_group").hide();
	 $("#mail_group input:mailin_list").val("");	 
	}
	$("#fancy_outer").height($("#create_space").height() + 50);
});

/*
 * Join space
 */

$("a.join_and_login_link").livequery("click", function(){
  var route = "/spaces/" + $(this).attr("name") +"/join" 
  $.get(route,
        {authenticity_token: "<%=form_authenticity_token()%>"},
        function(data){
          $("#join_div").replaceWith(data);
					$("#fancy_outer").height($("#join_div").height() + 50);
        }
      );
  return false;
});

$("a.join_and_register_link").livequery("click", function(){
	var route = "/spaces/" + $(this).attr("name") +"/join?register=true"
  $.get(route,
        {authenticity_token: "<%=form_authenticity_token()%>"},
        function(data){
          $("#join_div").replaceWith(data);
					$("#fancy_outer").height($("#join_div").height() + 50);
        }
      );
  return false;
});

/*
 * Log in
 */

$("a#login_link").fancybox({
  'hideOnContentClick' : false
});

openid = function(){
  $("#openid_form").show();
  $("#openid_link").hide();
	$("#fancy_outer").height($("#login_div").height() + 50);
};

$("a.login_lightbox_link").livequery("click", function(){
  var route = $(this).attr("href")
  $(this).attr("href","javascript:void(0)");
  $.get(route,
        {authenticity_token: "<%=form_authenticity_token()%>"},
        function(data){
          $("#login_div").replaceWith(data);
					$("#fancy_outer").height($("#login_div").height() + 50);
        }
      );
});

/*
 * Send Feedback
 */
 
$("a#feedback_link").fancybox({
  'hideOnContentClick' : false
});
 