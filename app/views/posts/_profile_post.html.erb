<% content_for :javascript do%>
  
  <%= render :partial => 'posts/collapse_expand', :locals => { :selected_post => selected_post, :post => post } %>
  
<%end%>

<%div_for post do%>

   <p id="topic" style="display:inline">Topic:  <%=link_to thread_title(post), space_post_path(post.space, thread(post)) if post.space.authorizes?([:read, :performance],:to=> current_user) %> in the space <%= post.authorizes?([:read, :content], :to =>current_user) ? link_to(post.space.name ,space_path(post.space)) : post.space.name %></p>

   <p id="collapsed_post_<%=post.id%>" style="display:none">
     <%=sanitize(first_words(post.text,200))%><br />
     <%=link_to "more>>", "javascript:expand_post_#{post.id}()"%>
   </p>

   <p id="expanded_post_<%=post.id%>">
   <%=sanitize(post.text)%><br />
   <%=link_to image_tag("icons/comment-edit.png", :alt => "edit comment",:class=>"icon" ), get_edit_route(post), :title => "edit comment" if post.authorizes?(:update, :to => current_user)%>
   </p>
<%end%>