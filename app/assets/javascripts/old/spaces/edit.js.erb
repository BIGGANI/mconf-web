//= require jquery/jquery.jeditable
//= require jquery/jquery.jcrop

$(function() {

  if (isOnPage('spaces', 'edit|update')) {

  selectDefaultImage = function(image){
    $("#space_image").attr('value', "default_space_logos/" + image);
    $("#selected_logo_image").attr('src', "/assets/default_space_logos/" + image);
  }

  selectGeneratedImage = function(image){
    $("#space_image").attr('value', image);
    $("#selected_logo_image").attr('src', "/assets/" + image + "?" + (new Date()).getTime());
  }

  closeUploadLogo = function(){
    $("#default_upload_logo").hide("slow");
    $("#open_upload_logo_link").show();
    $("#close_upload_logo_link").hide();
  }

  closeTextLogo = function(){
    $("#default_text_logo").hide("slow");
    $("#open_text_logo_link").show();
    $("#close_text_logo_link").hide();
  }

  closeGallery = function (){
    $("#default_space_images").hide("slow");
    $("#open_gallery_link").show();
    $("#close_gallery_link").hide();
  }

  openGallery = function (){
    $("#default_space_images").show("slow");
    $("#close_gallery_link").show();
    $("#open_gallery_link").hide();
  }

  openUploadLogo = function (){
    $("#default_upload_logo").show("slow");
    $("#open_upload_logo_link").hide();
    $("#close_upload_logo_link").show();
  }

  openTextLogo = function(){
    $("#default_text_logo").show("slow");
    $("#open_text_logo_link").hide();
    $("#close_text_logo_link").show();
  }

  var dateTime = new Date();
  var rand = dateTime.getHours() + "" + dateTime.getMinutes() + "" + dateTime.getSeconds() + "" + dateTime.getMilliseconds();

  $("#logo_rand").attr('value', rand);
  $("#space_rand_value").attr('value', rand);

  $("#generate_text_logo_button").livequery('click',function(){
    $.get('/logos/new?text='+ ($("#space_text_logo").val()) + '&rand_name=' + rand , function(data) {
      $('#generated_text_logos').html(data);
    });
  });

  function cropImage (c){
    $("#crop_size_x").val(c.x);
    $("#crop_size_y").val(c.y);
    $("#crop_size_height").val(c.h);
    $("#crop_size_width").val(c.w);
  };

  $("#jedit_form #public_checkbox").livequery('click', function(event) {
    if ($(this).is(':checked')) {
      $("#private_check").hide();
      $('#moderatorPW').attr('disabled', true);
      $('#attendeePW').attr('disabled', true);
    }
    else{
      $("#private_check").show();
      $('#moderatorPW').removeAttr('disabled');
      $('#attendeePW').removeAttr('disabled');
    }
  });


  $("#nonjavascript_form").remove();
  $("#jedit_form").show();

  edit_name = function(){
    $('#space_name').click();
    $('#edit_name_icon').hide();
  };

  edit_description = function(){
    $('#space_description').click();
    $('#edit_description_icon').hide();
  };

  edit_moderatorPW = function(){
    $('#space_moderatorPW').show();
    $('#space_moderatorPW').click();
    $('#edit_moderatorPW_icon').hide();
  };

  edit_attendeePW = function(){
    $('#space_attendeePW').show();
    $('#space_attendeePW').click();
    $('#edit_attendeePW_icon').hide();
  };

  $("#edit_space_button").click(function(){
    $("form#edit_logo_form").submit();
  });

  edit_logo_fun = function(){
    $('div#update_logo').show();
    $('#logo_preview').hide();
    $(".user").fadeOut("slow",function(){$("#edit_logo_menu").fadeIn("slow");$("#default_space_images").fadeIn("slow");});
    closeTextLogo();
    closeUploadLogo();
  };

  }

});
