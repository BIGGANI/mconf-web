$(document).ready(function() {

// We'll target all AREA elements with alt tags (Don't target the map element!!!)
   $('#most-active-spaces img').qtip(
   {
      content: {
         attr: 'alt' // Use the ALT attribute of the area map for the content
      },
      position: {
        corner: {
           target: 'topMiddle',
           tooltip: 'center'
        }
      },
      hide: {
        fixed: true // Make it fixed so it can be hovered over
      }
   });

  // clicking the items in the components menu changes the component
  // active in the slider
  $("#components-menu .content-block").livequery("click", function() {
    var linkIndex = $(this).prevAll().length;
    updateComponentsMenu(linkIndex+1, 1);
  });

  // method to update the component visible in the slider
  // and the item selected in #components-menu
  // updates the slider if 'update' is true
  var updateComponentsMenu = function(index, update) {
    sel = $("#components-menu .content-block-selected");
    sel.removeClass("content-block-selected");
    sel.addClass("content-block");
    obj = $("#components-menu .content-block:eq(" + (index-1) + ")");
    obj.removeClass("content-block");
    obj.addClass("content-block-selected");
    if (update != null) {
      $('#components-images').anythingSlider(index);
    }
  }

  // updates the item selected in #components-menu
  var updateComponentsSlider = function(slider) {
    var cap = slider.$currentPage.find('.caption').html();
    $('#components-description .content').html(cap).fadeIn(200);
  };

  // the component slider
  $('#components-images').anythingSlider({
    theme: 'default',
    expand: false,
    resizeContents: false,
    easing: "swing",
    buildArrows: false,
    buildNavigation: false,
    buildStartStop: true,
    startText: "Start",
    stopText: "Stop",
    enableArrows: false,
    enableNavigation: false,
    enableStartStop: true,
    enableKeyboard: true,
    autoPlay: true,
    autoPlayLocked: false,
    resumeDelay: 15000,
    autoPlayDelayed: false,
    delay: 8000,
    animationTime: 300,
    onSlideBegin: function(e, slider) {
      $('#components-description .content').fadeOut(200);
      updateComponentsMenu(slider.targetPage);
    },
    onInitialized: function(e, slider) {
      updateComponentsSlider(slider);
      updateComponentsMenu(slider.currentPage);
    },
    onSlideComplete: function(slider) {
      updateComponentsSlider(slider);
      updateComponentsMenu(slider.currentPage);
    }
  });

});
